import { JwtService } from '@nestjs/jwt';
import { ConfigService } from '@nestjs/config';
import Redis from 'ioredis';
import { UsersService } from '../users/users.service.js';
import { User } from '../users/entities/user.entity.js';
import { AuditLoggerService } from '../../core/audit/audit-logger.service.js';
import { LoggerService } from '../../common/logger/logger.service.js';
import type { AuthResponse, TokenResponse } from './dto/auth.dto.js';
export declare class AuthService {
    private readonly usersService;
    private readonly jwtService;
    private readonly configService;
    private readonly auditLogger;
    private readonly logger;
    private readonly redis;
    private readonly accessTokenExpiry;
    private readonly refreshTokenExpiry;
    private readonly REFRESH_TOKEN_PREFIX;
    private readonly PASSWORD_RESET_PREFIX;
    constructor(usersService: UsersService, jwtService: JwtService, configService: ConfigService, auditLogger: AuditLoggerService, logger: LoggerService, redis: Redis);
    validateUser(email: string, password: string): Promise<User | null>;
    login(user: User, ipAddress?: string, userAgent?: string): Promise<AuthResponse>;
    logout(userId: string, refreshToken: string, ipAddress?: string): Promise<void>;
    refreshAccessToken(userId: string, refreshToken: string): Promise<TokenResponse>;
    requestPasswordReset(email: string): Promise<void>;
    resetPassword(token: string, newPassword: string): Promise<void>;
    private storeRefreshToken;
    private validateRefreshToken;
    private invalidateRefreshToken;
    private invalidateAllRefreshTokens;
    private parseExpiry;
}
